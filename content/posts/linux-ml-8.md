---
title: "Linux ã‚³ãƒžãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆ: ImageMagick"
date: 2023-06-20
draft: false

series:
  - æ©Ÿæ¢°å­¦ç¿’ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®Linux
featured_image: "/images/lmle/8-imagemagick/hero.jpg"

---

ã“ã®è¨˜äº‹ã¯ã€ã‚·ãƒªãƒ¼ã‚º [æ©Ÿæ¢°å­¦ç¿’ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®Linux](/series/æ©Ÿæ¢°å­¦ç¿’ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®linux) ã®ç¬¬8å›žã§ã™ã€‚

## å‰å›žã®å¾©ç¿’

[å‰å›žã®è¨˜äº‹](/posts/linux-ml-7)ã¾ã§ã§ã€ `find`ã€`tr`ã€`cut` ã‚³ãƒžãƒ³ãƒ‰ã‚’çµ„ã¿åˆã‚ã›ãŸãƒ‘ã‚¤ãƒ—å‡¦ç†ã‚’ç´¹ä»‹ã—ãŸã€‚

ä»Šå›žã‹ã‚‰ã¯ã€ãƒ‘ã‚¤ãƒ—æ©Ÿèƒ½ã‚’ä½¿ã£ãŸåˆ¥ã®ä¾‹ã¨ã—ã¦ã€`find` ã‚³ãƒžãƒ³ãƒ‰ã¨ç”»åƒç·¨é›†ãƒ„ãƒ¼ãƒ« ImageMagick ã‚’ä½¿ã£ã¦å¤§é‡ã®ç”»åƒã‚’åŠ¹çŽ‡çš„ã«ãƒªã‚µã‚¤ã‚ºã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã„ã“ã†ã€‚

ã“ã®è¨˜äº‹ã§ã¯ ImageMagick ã®ä½¿ã„æ–¹ã‚’ç´¹ä»‹ã—ã€æ¬¡å›žã®è¨˜äº‹ã§ã¯ `find` ã¨ ImageMagick ã‚’çµ„ã¿åˆã‚ã›ã‚‹æ–¹æ³•ã‚’è€ƒãˆã¦ã„ãã€‚

## ImageMagick ã¨ã¯ï¼Ÿ

ImageMagick ã¯ã€**ã‚³ãƒžãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ä¸Šã§åˆ©ç”¨ã§ãã‚‹ç”»åƒç·¨é›†ãƒ„ãƒ¼ãƒ«ç¾¤**ã ã€‚
ç”»åƒã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆå¤‰æ›ã€ãƒªã‚µã‚¤ã‚ºãƒ»ã¼ã‹ã—ãƒ»å›žè»¢ãªã©ã®ç·¨é›†ã€ã•ã‚‰ã«ã¯CGã®ä½œæˆãªã©å¹…åºƒã„æ©Ÿèƒ½ã‚’ã‚‚ã¡ã€Linux ã‚³ãƒžãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ä¸Šã§ç”»åƒã‚’åŠ å·¥ã™ã‚‹ã¨ãã«åºƒãç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ã€‚

ImageMagick ã¯å˜ä½“ã®ãƒ„ãƒ¼ãƒ«ã§ã¯ãªãã€`convert`ï¼ˆç”»åƒåŠ å·¥ã‚³ãƒžãƒ³ãƒ‰ï¼‰ã€`mogrify`ï¼ˆç”»åƒã®ä¸Šæ›¸ãç·¨é›†ã‚³ãƒžãƒ³ãƒ‰ï¼‰ã€`identify`ï¼ˆç”»åƒã®æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰ï¼‰ãªã©ã€ã„ãã¤ã‹ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’ã¾ã¨ã‚ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚

ãã®ä¸­æ ¸ã‚’ãªã™ã®ãŒ `convert`ï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³7ã§ã¯ `magick`ï¼‰ã‚³ãƒžãƒ³ãƒ‰ã ã€‚
ã“ã®ã‚³ãƒžãƒ³ãƒ‰ã²ã¨ã¤ã§ã€ç”»åƒã®åŠ å·¥ã‚„ä½œæˆãªã©ã®ã•ã¾ã–ã¾ãªæ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã€‚

> **ðŸ“” ãƒŽãƒ¼ãƒˆ**
>
> ImageMagick ã¯ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã‚³ãƒžãƒ³ãƒ‰ã®åå‰ã‚„æ©Ÿèƒ½ãŒä¸€éƒ¨ç•°ãªã‚‹ã€‚
> æœ€æ–°ã®**ãƒãƒ¼ã‚¸ãƒ§ãƒ³7**ã§ã¯ `convert` ã‚³ãƒžãƒ³ãƒ‰ã®åå‰ãŒ `magick` ã«ãªã‚‹ã€ã¨ã„ã†å¤§ããªå¤‰åŒ–ãŒã‚ã£ãŸã€‚
> ã“ã®ãŸã‚ã€æœ€æ–°ã® ImageMagick å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ `magick` ã‚³ãƒžãƒ³ãƒ‰ã®åˆ©ç”¨ãŒå‰æã¨ãªã£ã¦ã„ã‚‹ã€‚
>
> ãã‚Œã«å¯¾ã—ã¦ã€Ubuntu ãªã©ä¸€éƒ¨ã® Linux ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€å°‘ã—å¤ã„ **ãƒãƒ¼ã‚¸ãƒ§ãƒ³6** ã® ImageMagick ãŒãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚‹ã€‚
>
> æœ¬ç¨¿ã§ã¯ã€ImageMagick v6 ã® `convert` ã‚³ãƒžãƒ³ãƒ‰ã‚’å‰æã¨ã—ã¦ã„ã‚‹ãŒã€ImageMagick v7 ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸç’°å¢ƒã§ã¯ `convert` ã‚’ `magick` ã«é©å®œèª­ã¿æ›¿ãˆã¦ã»ã—ã„ã€‚
>
> ```console
> $ # ImageMagick v6 ã®ã‚³ãƒžãƒ³ãƒ‰ä¾‹
> $ convert input.jpg -rotate 30 output.png
> $ # ImageMagick v7 ã§ã®ã€åŒç­‰ã®ã‚³ãƒžãƒ³ãƒ‰
> $ magick input.jpg -rotate 30 output.png
> ```
>
> ãªãŠã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ ImageMagick ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ã€ä¸‹è¨˜ã®ã‚³ãƒžãƒ³ãƒ‰ã§ç¢ºèªã§ãã‚‹ã€‚
>
> ```console
> $ identify --version
> Version: ImageMagick 6.9.10-23 Q16 x86_64 20190101 https://imagemagick.org
> ```

## `convert` ã‚’ä½¿ã£ãŸç”»åƒåŠ å·¥

ãã‚Œã§ã¯ã€`convert` (`magick`) ã‚³ãƒžãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ç”»åƒã‚’åŠ å·¥ã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã„ã“ã†ã€‚

`convert` ã‚’ä½¿ã£ãŸç”»åƒå‡¦ç†ã®æµã‚Œã¯ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

1. ã‚ã‚‹ç”»åƒã‚’**å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«**ã¨ã—ã¦å—ã‘å–ã‚Šã€
2. **æ“ä½œ**ï¼ˆå›žè»¢ã‚„ã¼ã‹ã—ãªã©ï¼‰ã‚’ã—ã¦ã€
3. **å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«**ã«ã€æ“ä½œã‚’é©ç”¨ã—ãŸç”»åƒã‚’æ›¸ãå‡ºã™ã€‚

å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã›ãšã«CGã‚’ä½œæˆã™ã‚‹å ´åˆã‚„ã€è¤‡æ•°ã®ç”»åƒã‚’æ‰±ã†å ´åˆã‚‚ã‚ã‚‹ãŒã€ã¾ãšã¯åŸºæœ¬çš„ãªã€Œå…¥åŠ›ã€â†’ã€Œæ“ä½œã€â†’ã€Œå‡ºåŠ›ã€ã®æµã‚Œã‚’ãŠã•ãˆã¦ãŠã“ã†ã€‚

`convert` ã‚³ãƒžãƒ³ãƒ‰ã®åŸºæœ¬çš„ãªæ–‡æ³•ã¯ã€æ¬¡ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚

```
convert å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ« [ã‚ªãƒšãƒ¬ãƒ¼ã‚¿] å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«
```

å›žè»¢ã‚„ã¼ã‹ã—ãªã©ã®æ“ä½œãƒ»å‡¦ç†ã¯ã€Œ**ã‚ªãƒšãƒ¬ãƒ¼ã‚¿**ã€ã‚’ä½¿ã£ã¦æŒ‡å®šã™ã‚‹ã€‚
ä¾‹ãˆã° `-blur` ã‚’æŒ‡å®šã™ã‚Œã°ã¼ã‹ã—å‡¦ç†ã€ `-border` ãªã‚‰ã°æž ç·šã‚’ã¤ã‘ã‚‹å‡¦ç†ã€ã¨ã„ã£ãŸå…·åˆã«ãªã‚‹ã€‚
ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã«ã¯ã€ã¼ã‹ã—ã®åº¦åˆã„ã‚„ç¸ã®å¹…ãªã©ã®è¨­å®šæƒ…å ±ã‚’ã¤ã‘ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚

ä¾‹ãˆã°ã€æ¬¡ã®ã‚³ãƒžãƒ³ãƒ‰ã¯ ã€Œ`input.jpg` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€æ™‚è¨ˆå›žã‚Šã«30åº¦å›žè»¢ã—ã¦ã€`output.png` ã¨ã—ã¦æ›¸ãå‡ºã™ã€ã¨ã„ã†æ„å‘³ã«ãªã‚‹ã€‚

```console
$ convert input.jpg -rotate 30 output.png
```

1ã¤ã® `convert` ã‚³ãƒžãƒ³ãƒ‰ã§ã€è¤‡æ•°ã®æ“ä½œãƒ»å‡¦ç†ã‚’ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚
ä¾‹ãˆã°ã€æ¬¡ã®ã‚³ãƒžãƒ³ãƒ‰ã§ã¯ã€Œç”»åƒã‚’ã¼ã‹ã™å‡¦ç†ã€ã¨ã€Œç·‘è‰²ã®æž ç·šã‚’è¿½åŠ ã™ã‚‹å‡¦ç†ã€ãŒé †ç•ªã«é©ç”¨ã•ã‚Œã‚‹ã€‚

```console
$ convert input.jpg -blur 15x5 -bordercolor limegreen -border 5 output.png
```

![convert ã‚’ä½¿ã£ãŸç”»åƒåŠ å·¥å‡¦ç†ã®æµã‚Œã¨ã‚³ãƒžãƒ³ãƒ‰ä¾‹](/images/lmle/8-imagemagick/convert_info_1.png)

![1ã¤ã® convert ã‚³ãƒžãƒ³ãƒ‰å†…ã§ã€è¤‡æ•°ã®æ“ä½œãƒ»å‡¦ç†ã‚’ã™ã‚‹ã®ã‚‚OK](/images/lmle/8-imagemagick/convert_info_2.png)

`convert` ã‚³ãƒžãƒ³ãƒ‰ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚„ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã¯ã¨ã¦ã‚‚æ•°ãŒå¤šãã€ã“ã®è¨˜äº‹ã§ã™ã¹ã¦ã‚’ç´¹ä»‹ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚
è©³ç´°ãªä½¿ã„æ–¹ã¯[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://imagemagick.org/script/command-line-processing.php)ã‚„ã€æœ‰å¿—ã«ã‚ˆã‚‹æ—¥æœ¬èªžãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ï¼ˆ[Imagemagick ã®ä½¿ã„æ–¹æ—¥æœ¬èªžãƒžãƒ‹ãƒ¥ã‚¢ãƒ«](https://imagemagick.biz/)ã€[ã¨ã‚‰ã‚Šã‚‚ã‚“](https://pen.envr.tsukuba.ac.jp/~torarimon/?Imagemagick)ãªã©ï¼‰ã‚’å‚ç…§ã—ã¦ã»ã—ã„ã€‚

## `convert` ã®ä½¿ç”¨ä¾‹

ã“ã“ã§ã¯ã€`convert` ã®ä»£è¡¨çš„ãªåˆ©ç”¨ä¾‹ã¨ã—ã¦ã€Œç”»åƒãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã®å¤‰æ›ã€ã¨ã€Œç”»åƒã®ãƒªã‚µã‚¤ã‚ºã€ã®2ã¤ã‚’ç´¹ä»‹ã™ã‚‹ã€‚

### ç”»åƒãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆå¤‰æ›

`convert` ã®ã‚ˆãã‚ã‚‹ä½¿ã„æ–¹ã®1ã¤ã¯ã€ç”»åƒã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã‚’å¤‰æ›ã™ã‚‹ã€ã¨ã„ã†ã‚‚ã®ã ã€‚

ä¾‹ãˆã°ã€BMP ç”»åƒã‚’ PNG å½¢å¼ã«å¤‰æ›ã—ãŸã„ã¨ã—ã‚ˆã†ã€‚
ã“ã®å ´åˆã€å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã« BMP ç”»åƒã®åå‰ã€å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã™ PNG ç”»åƒã®åå‰ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å¤‰æ›ãŒã§ãã‚‹ã€‚
ç”»åƒã®åŠ å·¥ã¯ã—ãªã„ã®ã§ã€ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã¯ã¤ã‘ãªãã¦ã‚ˆã„ã€‚

```console
$ convert ./digit.bmp ./digit.png
```

ã“ã‚Œã§ã€BMP ç”»åƒãŒ PNG å½¢å¼ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚

ImageMagick ã¯ã€ãŸãã•ã‚“ã®ç”»åƒãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ ([ä¸€è¦§](https://imagemagick.org/script/formats.php#supported))ã€‚

> **ðŸ“” ãƒŽãƒ¼ãƒˆ**
>
> ImageMagick ã¯éžå¸¸ã«å¤šãã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã«å¯¾å¿œã—ã¦ã„ã‚‹ãŒã€è£ã‚’è¿”ã›ã°ã€ç”»åƒã®èª­ã¿è¾¼ã¿ãƒ»æ›¸ãå‡ºã—ã«é–¢ä¿‚ã™ã‚‹è„†å¼±æ€§ãŒç”Ÿã˜ã‚„ã™ã„ã€‚
> ã“ã®ãŸã‚ã€ImageMagick ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ **ä¸€éƒ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãŒç„¡åŠ¹åŒ–** ã•ã‚Œã¦ã„ã‚‹ã€‚
> 
> ä¾‹ãˆã°ã€PDF å½¢å¼ã‚„ EPS å½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿æ›¸ãã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚
> 
> ```console
> $ convert ./sunset.png ./sunset.pdf
> convert-im6.q16: attempt to perform an operation not allowed by the security policy `PDF' @ error/constitute.c/IsCoderAuthorized/408.
> ```
> 
> ImageMagick ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã¯ `policy.xml` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã•ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã‚’æ›¸ãæ›ãˆã‚‹ã“ã¨ã§ã‚¨ãƒ©ãƒ¼ã‚’å›žé¿ã§ãã‚‹ã€‚
>
> è¨­å®šã®è©³ç´°ã«ã¤ã„ã¦ã¯[ImageMagickå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://imagemagick.org/script/security-policy.php)ã€ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ä»¥å¤–ã®è¨­å®šé …ç›®ã«ã¤ã„ã¦ã¯[ã‚¯ãƒƒã‚¯ãƒ‘ãƒƒãƒ‰é–‹ç™ºè€…ãƒ–ãƒ­ã‚°](https://techlife.cookpad.com/entry/2016/05/18/180703)ã€ImageMagick ã®è„†å¼±æ€§ã«ã¤ã„ã¦ã¯[yoyaæ°ã®è€ƒå¯Ÿ](https://qiita.com/yoya/items/2076c1f5137d4041e3aa)ãŒè©³ã—ã„ã€‚

### ç”»åƒã®ãƒªã‚µã‚¤ã‚º

ç”»åƒã®ãƒªã‚µã‚¤ã‚ºï¼ˆæ‹¡å¤§ã‚„ç¸®å°ï¼‰ã‚’ã™ã‚‹ã®ã‚‚ã€`convert` ã‚’ä½¿ã£ã¦è¡Œã‚ã‚Œã‚‹ã“ã¨ã®å¤šã„å‡¦ç†ã®ã²ã¨ã¤ã ã€‚

ç”»åƒã‚’ãƒªã‚µã‚¤ã‚ºã™ã‚‹ã«ã¯ `-resize` ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã€‚ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã®å¾Œã‚ã«ã€ç¸®å°å¾Œã®ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã™ã‚‹ã€‚

è©¦ã—ã«ã€ç”»åƒã‚’ç¸¦ãƒ»æ¨ª 128 ãƒ”ã‚¯ã‚»ãƒ«ã«ãªã‚‹ã‚ˆã†ç¸®å°ã—ã¦ã¿ã‚ˆã†ã€‚

```console
$ convert image.png -resize 128x128 thumbnail.png
```

![ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç¶­æŒã—ã¦ç¸®å°ã—ãŸå ´åˆã®ã€å‡¦ç†å‰å¾Œã®ç”»åƒ](/images/lmle/8-imagemagick/convert_resize_wo_exclamation.png)

æ­£æ–¹å½¢ã§ã¯ãªãã€ã‚‚ã¨ã®ç¸¦æ¨ªæ¯”ã‚’ä¿ã£ãŸç¸®å°ç”»åƒãŒå‡ºåŠ›ã•ã‚Œã¦ã—ã¾ã£ãŸã€‚

å®Ÿã¯ã€ç¸®å°å¾Œã®ã‚µã‚¤ã‚ºã‚’`128x128` ã«æŒ‡å®šã™ã‚‹ã¨ã€Œ**ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç¶­æŒã—ãŸã¾ã¾**128Ã—128px ã®æž å†…ã«åŽã¾ã‚‹ã‚ˆã†ã«ç”»åƒã‚’ç¸®å°ã™ã‚‹ã€ã¨ã„ã†æ„å‘³ã«ãªã£ã¦ã—ã¾ã†ã€‚

ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç„¡è¦–ã—ã¦128pxå››æ–¹ã«ç¸®å°ã—ãŸã„å ´åˆã€**ã‚µã‚¤ã‚ºæŒ‡å®šã®æœ€å¾Œã« `!` ã‚’ã¤ã‘ã‚‹**ã€‚
ã¾ãŸã€ã“ã®å ´åˆã¯ã‚µã‚¤ã‚ºã‚’ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆï¼ˆ`'`ï¼‰ã§å›²ã‚€å¿…è¦ãŒã‚ã‚‹ï¼ˆãã®ç†ç”±ã«ã¤ã„ã¦ã¯ã€ã¹ã¤ã®è¨˜äº‹ã§èª¬æ˜Žã—ãŸã„ï¼‰ã€‚

```console
$ convert image.png -resize '128x128!' thumbnail.png
```

![ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç„¡è¦–ã—ã¦ç¸®å°ã—ãŸå ´åˆã®ã€å‡¦ç†å‰å¾Œã®ç”»åƒ](/images/lmle/8-imagemagick/convert_resize_with_exclamation.png)

ã“ã‚Œã§ã€æ„å›³ã—ãŸé€šã‚Šã«ç”»åƒãŒç¸®å°ã•ã‚ŒãŸã€‚
ãªãŠã€ã‚µã‚¤ã‚ºæŒ‡å®šã®æ–¹æ³•ã¯ã“ã®ä»–ã«ã‚‚ã„ã‚ã„ã‚ã‚ã‚‹ã€‚[ImageMagickå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://imagemagick.org/script/command-line-processing.php#geometry)ã§è©³ã—ãèª¬æ˜Žã•ã‚Œã¦ã„ã‚‹ã®ã§ã€èˆˆå‘³ã®ã‚ã‚‹æ–¹ã¯å‚ç…§ã—ã¦ã»ã—ã„ã€‚

## ä¾‹é¡Œ

æ©Ÿæ¢°å­¦ç¿’ã®åˆ†é‡Žã§ `convert` ã‚³ãƒžãƒ³ãƒ‰ã‚’ä½¿ã†ã‚±ãƒ¼ã‚¹ã¨ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªèª²é¡Œã‚’è€ƒãˆã¦ã¿ã‚ˆã†ã€‚

> **â“ èª²é¡Œ**
>
> æ¬¡ã®ã‚ˆã†ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’ã‚‚ã¤ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒã‚ã‚‹ã¨ã—ã‚ˆã†ã€‚
>
> ```
> dataset
>   |-thumbnails/
>   |-train/
>   |   |-00000000.JPG
>   |   |-00000001.JPG
>   |   |-00000002.JPG
>   |   | ...
>   |   `-00009999.JPG
>   `-val/
>       |-00010000.JPG
>       |-00010001.JPG
>       |-00010002.JPG
>       | ...
>       `-00010999.JPG
> ```
>
> `dataset/train` ã¨ `dataset/val` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã«ã‚ã‚‹ã™ã¹ã¦ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¸®å°ã—ã¦ã€`dataset/thumbnails`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã—ãŸã„ã€‚
>
> ç¸®å°ã—ãŸç”»åƒã¯å¹…ãƒ»é«˜ã•ã¨ã‚‚ 256px ã¨ã—ã€æ¬¡ã®ã‚ˆã†ã« `thumbnails/` ã®ç›´ä¸‹ã«ä¿å­˜ã—ãŸã„ã¨ã—ã‚ˆã†ã€‚
>
> ```
> dataset
>   |-thumbnails/
>   |   |-thumb_00000000.JPG
>   |   |-thumb_00000001.JPG
>   |   | ...
>   |   `-thumb_00010999.JPG
> ```
>
> ã©ã†ã™ã‚Œã°ã„ã„ã ã‚ã†ã‹ï¼Ÿ

ã€Œã™ã¹ã¦ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¸®å°ã™ã‚‹ã€æ–¹æ³•ã¯æ¬¡å›žã®è¨˜äº‹ã§è€ƒãˆã‚‹ã¨ã—ã¦ã€ã¾ãšã¯1æžšã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ 256px å››æ–¹ã«ç¸®å°ã™ã‚‹å‡¦ç†ã‚’è€ƒãˆã‚ˆã†ã€‚

å…ˆã»ã©ç´¹ä»‹ã—ãŸã‚ˆã†ã«ã€ `convert` ã‚³ãƒžãƒ³ãƒ‰ã® `-resize` ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ãˆã°ç”»åƒã‚’ç¸®å°ã§ãã‚‹ã€‚
ä¾‹é¡Œã§ã¯å¹…ãƒ»é«˜ã•ã¨ã‚‚ 256px ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç„¡è¦–ã™ã‚‹ãŸã‚ã« `!` ã‚’ä½¿ãŠã†ã€‚

```console
$ cd dataset/
$ convert train/00000000.JPG -resize '256x256!' thumbnails/thumbnail_00000000.JPG
```

![convert ã® -resize ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ç¸®å°ã—ãŸçµæžœã®ç”»åƒ](/images/lmle/8-imagemagick/convert_resize_example.png)

ã‚‚ã¨ã®ç”»åƒã¨æ¯”è¼ƒã™ã‚‹ã¨ã€ç”»åƒãŒç¸®å°ã•ã‚Œã¦ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ãŒ 1:1 ã«ãªã£ã¦ã„ã‚‹ã®ãŒã‚ã‹ã‚‹ã€‚

## ã¾ã¨ã‚

ä»Šå›žã®è¨˜äº‹ã§ã¯ã€ImageMagick ã‚’ä½¿ã£ã¦ã‚³ãƒžãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ä¸Šã§ç”»åƒã‚’åŠ å·¥ãƒ»ç·¨é›†ã™ã‚‹æ–¹æ³•ã‚’å­¦ã‚“ã ã€‚
ã‚³ãƒžãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’ä½¿ã£ãŸã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿æ“ä½œã¯ã€ç”»åƒã®ã‚ˆã†ãªãƒžãƒ«ãƒãƒ¡ãƒ‡ã‚£ã‚¢ã¨ã¯ç¸é ã„å°è±¡ã‚’ã‚‚ã¤äººã‚‚ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŒã€å®Ÿã¯CLIç’°å¢ƒã§ã‚‚æ§˜ã€…ãªãƒžãƒ«ãƒãƒ¡ãƒ‡ã‚£ã‚¢ã®å‡¦ç†ãŒã§ãã‚‹ã€‚

ä»Šå›žã¯1æžšã®ç”»åƒã«å¯¾ã™ã‚‹å‡¦ç†ã®ã—ã‹ãŸã‚’ç´¹ä»‹ã—ãŸãŒã€ CLI ã®ãƒ„ãƒ¼ãƒ«ãŒçœŸä¾¡ã‚’ç™ºæ®ã™ã‚‹ã®ã¯ã€åŒã˜å‡¦ç†ã‚’ãŸãã•ã‚“ã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦é©ç”¨ã™ã‚‹ã¨ãã ã€‚
ã“ã®ã‚ˆã†ãªã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®é«˜ã•ã¯ã€å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†æ©Ÿæ¢°å­¦ç¿’ã®ç¾å ´ã§ã¯ã¨ã¦ã‚‚å½¹ã«ç«‹ã¤ã€‚

æ¬¡å›žã¯ã€ã“ã®ã‚ˆã†ãªå‡¦ç†ã‚’å¯èƒ½ã«ã™ã‚‹ `xargs` ã¨ã„ã†ã‚³ãƒžãƒ³ãƒ‰ã‚’ç´¹ä»‹ã—ã‚ˆã†ã€‚
`xargs` ã‚³ãƒžãƒ³ãƒ‰ã‚’ä½¿ãˆã°ã€å¤§é‡ã®ç”»åƒã‚’1ã¤ã®ã‚³ãƒžãƒ³ãƒ‰ã§æ“ä½œã§ãã‚‹ã ã‘ã§ãªãã€ä¸¦åˆ—å‡¦ç†ã«ã‚ˆã‚‹é«˜é€ŸåŒ–ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆã‚‚å¾—ã‚‰ã‚Œã‚‹ã€‚

ãã‚Œã§ã¯ã€æ¬¡å›žã®è¨˜äº‹ã‚‚ãŠæ¥½ã—ã¿ã«ï¼

> **ðŸŽ¯ ã¾ã¨ã‚**
>
> * **ImageMagick**: ã‚³ãƒžãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ç”»åƒå‡¦ç†ã‚’ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã€‚`convert` ã‚„ `identify` ãªã©ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’æä¾›ã™ã‚‹ã€‚
> * **`convert`**: ç”»åƒã‚’ç·¨é›†ã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰
>   * `convert input.jpg output.png`  
>     JPEG å½¢å¼ã®ç”»åƒï¼ˆ`input.jpg`ï¼‰ã‚’ PNG å½¢å¼ï¼ˆ`output.png`ï¼‰ã«å¤‰æ›ã—ã¦æ›¸ãå‡ºã™
>   * `convert input.jpg -rotate 30 output.png`  
>     ç”»åƒã‚’æ™‚è¨ˆå›žã‚Šã«30åº¦å›žè»¢ã—ã¦æ›¸ãå‡ºã™
>   * `convert input.jpg -resize 256x256 output.png`  
>     å…¥åŠ›ç”»åƒã®ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ä¿ã£ãŸã¾ã¾ã€256Ã—256px ã®æž å†…ã«åŽã¾ã‚‹ã‚ˆã†ã«ç¸®å°ã™ã‚‹
>   * `convert input.jpg -resize '256x256!' output.png`  
>     å…¥åŠ›ç”»åƒã®ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç„¡è¦–ã—ã¦ã€256Ã—256px ã«ç¸®å°ã™ã‚‹

> **â“ ç·´ç¿’èª²é¡Œ**
>
> * ImageMagick ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®è¨˜äº‹ã‚’å‚ç…§ã—ãªãŒã‚‰ã€æ¬¡ã®ã‚³ãƒžãƒ³ãƒ‰ãŒã©ã®ã‚ˆã†ãªå‡¦ç†ã‚’ã™ã‚‹ã‹ã€èª¬æ˜Žã—ã¦ã¿ã‚ˆã†ã€‚
>   1. ```console
>      $ convert input.png -crop 160x90+30+30 output.png
>      ```
>   1. ```console
>      $ convert input.png -resize '50%' output.png
>      ```
> * æ¬¡ã®2ã¤ã®ã‚³ãƒžãƒ³ãƒ‰ã«ã¤ã„ã¦ã€å‡ºåŠ›ã•ã‚Œã‚‹ç”»åƒã«ã©ã®ã‚ˆã†ãªé•ã„ãŒç”Ÿã˜ã‚‹ã‹ã€è€ƒãˆã¦ã¿ã‚ˆã†ã€‚
>   1. ```console
>      $ convert input.jpg -blur 15x5 -bordercolor limegreen -border 5 output.png
>      ```
>   1. ```console
>      $ convert input.jpg -bordercolor limegreen -border 5 -blur 15x5 output.png
>      ```
